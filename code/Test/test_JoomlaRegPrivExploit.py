import ID2TLib.TestLibrary as Lib
import Test.ID2TAttackTest as Test

sha_default = '1c8bea8fc72e0008c9b436ee6b019be5d5f4586ec1f403208293f97d57f13897'
sha_ips_not_in_pcap = '24225f22bbadf9cc6300f9a3891b7b66c559881f3bc1e46eca7c52e5bc1cb063'
sha_multiple_params = 'c47c53819f08afa46457a1caf05e3e22cfe04c1bce8038eeca9b41c2e4fd4457'

# TODO: improve coverage


class UnitTestJoomla(Test.ID2TAttackTest):
    def test_joomla_default(self):
        self.checksum_test([['JoomlaRegPrivExploit']], sha_default)

    def test_joomla_ips_not_in_pcap(self):
        self.checksum_test([['JoomlaRegPrivExploit', 'ip.src=1.1.1.1', 'ip.dst=2.2.2.2']], sha_ips_not_in_pcap)

    def test_joomla_multiple_params(self):
        ip_src = 'ip.src=' + Lib.test_pcap_ips[0]
        ip_dst = 'ip.dst=' + Lib.test_pcap_ips[1]
        self.checksum_test([['JoomlaRegPrivExploit', ip_src, ip_dst, 'mac.src=00:0C:21:1C:60:61',
                             'mac.dst=04:0C:32:2C:63:62', 'port.dst=42',
                             'target.host=www.ihopethisisnotarealwebsite.com']], sha_multiple_params)

    def test_joomla_order(self):
        self.order_test([['JoomlaRegPrivExploit']])
